<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- qrhiprofiler.cpp -->
  <title>QRhiProfiler Class | RHI 5.12</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
  <div class="main">
    <div class="main-rounded">
      <div class="navigationbar">
        <table><tr>
<td >Qt 5.12</td><td ><a href="qtrhi-index.html">RHI</a></td><td ><a href="qtrhi-module.html">C++ Classes</a></td><td >QRhiProfiler</td></tr></table><table class="buildversion"><tr>
<td id="buildversion" width="100%" align="right">Qt 5.12.0 Reference Documentation</td>
        </tr></table>
      </div>
    </div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#public-types">Public Types</a></li>
<li class="level1"><a href="#public-functions">Public Functions</a></li>
<li class="level1"><a href="#details">Detailed Description</a></li>
<li class="level2"><a href="#output-format">Output Format</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">QRhiProfiler Class</h1>
<!-- $$$QRhiProfiler-brief -->
<p>Collects resource and timing information from an active <a href="qrhi.html">QRhi</a>. <a href="#details">More...</a></p>
<!-- @@@QRhiProfiler -->
<div class="table"><table class="alignedsummary">
<tr><td class="memItemLeft rightAlign topAlign"> Header:</td><td class="memItemRight bottomAlign">   <span class="preprocessor">#include &lt;QRhiProfiler&gt;</span>
</td></tr><tr><td class="memItemLeft rightAlign topAlign"> qmake:</td><td class="memItemRight bottomAlign"> QT += rhi</td></tr></table></div><ul>
<li><a href="qrhiprofiler-members.html">List of all members, including inherited members</a></li>
</ul>
<a name="public-types"></a>
<h2 id="public-types">Public Types</h2>
<div class="table"><table class="alignedsummary">
<tr><td class="memItemLeft rightAlign topAlign"> class </td><td class="memItemRight bottomAlign"><b><a href="qrhiprofiler-cputime.html">CpuTime</a></b></td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> class </td><td class="memItemRight bottomAlign"><b><a href="qrhiprofiler-gputime.html">GpuTime</a></b></td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> enum </td><td class="memItemRight bottomAlign"><b><a href="qrhiprofiler.html#StreamOp-enum">StreamOp</a></b> { NewBuffer, ReleaseBuffer, NewBufferStagingArea, ReleaseBufferStagingArea, ..., FrameBuildTime }</td></tr>
</table></div>
<a name="public-functions"></a>
<h2 id="public-functions">Public Functions</h2>
<div class="table"><table class="alignedsummary">
<tr><td class="memItemLeft rightAlign topAlign"> </td><td class="memItemRight bottomAlign"><b><a href="qrhiprofiler.html#dtor.QRhiProfiler">~QRhiProfiler</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="qrhiprofiler.html#addVMemAllocatorStats">addVMemAllocatorStats</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QRhiProfiler::CpuTime </td><td class="memItemRight bottomAlign"><b><a href="qrhiprofiler.html#frameBuildTimes">frameBuildTimes</a></b>(QRhiSwapChain *<i>sc</i>) const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> int </td><td class="memItemRight bottomAlign"><b><a href="qrhiprofiler.html#frameTimingWriteInterval">frameTimingWriteInterval</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QRhiProfiler::CpuTime </td><td class="memItemRight bottomAlign"><b><a href="qrhiprofiler.html#frameToFrameTimes">frameToFrameTimes</a></b>(QRhiSwapChain *<i>sc</i>) const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QRhiProfiler::GpuTime </td><td class="memItemRight bottomAlign"><b><a href="qrhiprofiler.html#gpuFrameTimes">gpuFrameTimes</a></b>(QRhiSwapChain *<i>sc</i>) const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="qrhiprofiler.html#setDevice">setDevice</a></b>(QIODevice *<i>device</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="qrhiprofiler.html#setFrameTimingWriteInterval">setFrameTimingWriteInterval</a></b>(int <i>frameCount</i>)</td></tr>
</table></div>
<a name="details"></a>
<!-- $$$QRhiProfiler-description -->
<div class="descr">
<h2 id="details">Detailed Description</h2>
<p>Collects resource and timing information from an active <a href="qrhi.html">QRhi</a>.</p>
<p>A <a href="qrhiprofiler.html">QRhiProfiler</a> is present for each <a href="qrhi.html">QRhi</a>. Query it via <a href="qrhi.html#profiler">QRhi::profiler</a>(). The profiler is active only when the <a href="qrhi.html">QRhi</a> was created with <a href="qrhi.html#Flag-enum">QRhi::EnableProfiling</a>. No data is collected otherwise.</p>
<p><b>Note: </b>GPU timings are only available when <a href="qrhi.html">QRhi</a> indicates that <a href="qrhi.html#Feature-enum">QRhi::Timestamps</a> is supported.</p><p>Besides collecting data from the <a href="qrhi.html">QRhi</a> implementations, some additional values are calculated. For example, for textures and similar resources the profiler gives an estimate of the complete amount of memory the resource needs.</p>
<a name="output-format"></a>
<h4 >Output Format</h4>
<p>The output is comma-separated text. Each line has a number of comma-separated entries and each line ends with a comma.</p>
<p>For example:</p>
<pre class="cpp plain">

  1,0,140446057946208,Triangle vbuf,type,0,usage,1,logical_size,84,effective_size,84,backing_gpu_buf_count,1,backing_cpu_buf_count,0,
  1,0,140446057947376,Triangle ubuf,type,2,usage,4,logical_size,68,effective_size,256,backing_gpu_buf_count,2,backing_cpu_buf_count,0,
  1,1,140446057950416,,type,0,usage,1,logical_size,112,effective_size,112,backing_gpu_buf_count,1,backing_cpu_buf_count,0,
  1,1,140446057950544,,type,0,usage,2,logical_size,12,effective_size,12,backing_gpu_buf_count,1,backing_cpu_buf_count,0,
  1,1,140446057947440,,type,2,usage,4,logical_size,68,effective_size,256,backing_gpu_buf_count,2,backing_cpu_buf_count,0,
  1,1,140446057984784,Cube vbuf (textured),type,0,usage,1,logical_size,720,effective_size,720,backing_gpu_buf_count,1,backing_cpu_buf_count,0,
  1,1,140446057982528,Cube ubuf (textured),type,2,usage,4,logical_size,68,effective_size,256,backing_gpu_buf_count,2,backing_cpu_buf_count,0,
  7,8,140446058913648,Qt texture,width,256,height,256,format,1,owns_native_resource,1,mip_count,9,layer_count,1,effective_sample_count,1,approx_byte_size,349524,
  1,8,140446058795856,Cube vbuf (textured with offscreen),type,0,usage,1,logical_size,720,effective_size,720,backing_gpu_buf_count,1,backing_cpu_buf_count,0,
  1,8,140446058947920,Cube ubuf (textured with offscreen),type,2,usage,4,logical_size,68,effective_size,256,backing_gpu_buf_count,2,backing_cpu_buf_count,0,
  7,8,140446058794928,Texture for offscreen content,width,512,height,512,format,1,owns_native_resource,1,mip_count,1,layer_count,1,effective_sample_count,1,approx_byte_size,1048576,
  1,8,140446058963904,Triangle vbuf,type,0,usage,1,logical_size,84,effective_size,84,backing_gpu_buf_count,1,backing_cpu_buf_count,0,
  1,8,140446058964560,Triangle ubuf,type,2,usage,4,logical_size,68,effective_size,256,backing_gpu_buf_count,2,backing_cpu_buf_count,0,
  5,9,140446057945392,,type,0,width,1280,height,720,effective_sample_count,1,transient_backing,0,winsys_backing,0,approx_byte_size,3686400,
  11,9,140446057944592,,width,1280,height,720,buffer_count,2,msaa_buffer_count,0,effective_sample_count,1,approx_total_byte_size,7372800,
  9,9,140446058913648,Qt texture,slot,0,size,262144,
  10,9,140446058913648,Qt texture,slot,0,
  17,2019,140446057944592,,frames_since_resize,121,min_ms_frame_delta,9,max_ms_frame_delta,33,Favg_ms_frame_delta,16.1167,
  18,2019,140446057944592,,frames_since_resize,121,min_ms_frame_build,0,max_ms_frame_build,1,Favg_ms_frame_build,0.00833333,
  17,4019,140446057944592,,frames_since_resize,241,min_ms_frame_delta,15,max_ms_frame_delta,17,Favg_ms_frame_delta,16.0583,
  18,4019,140446057944592,,frames_since_resize,241,min_ms_frame_build,0,max_ms_frame_build,0,Favg_ms_frame_build,0,
  12,5070,140446057944592,,
  2,5079,140446057947376,Triangle ubuf,
  2,5079,140446057946208,Triangle vbuf,
  2,5079,140446057947440,,
  2,5079,140446057950544,,
  2,5079,140446057950416,,
  8,5079,140446058913648,Qt texture,
  2,5079,140446057982528,Cube ubuf (textured),
  2,5079,140446057984784,Cube vbuf (textured),
  2,5079,140446058964560,Triangle ubuf,
  2,5079,140446058963904,Triangle vbuf,
  8,5079,140446058794928,Texture for offscreen content,
  2,5079,140446058947920,Cube ubuf (textured with offscreen),
  2,5079,140446058795856,Cube vbuf (textured with offscreen),
  6,5079,140446057945392,,

</pre>
<p>Each line starts with <code>op</code>, <code>timestamp</code>, <code>res</code>, <code>name</code> where op is a value from <a href="qrhiprofiler.html#StreamOp-enum">StreamOp</a>, timestamp is a recording timestamp in milliseconds (qint64), res is a number (quint64) referring to the <a href="qrhiresource.html">QRhiResource</a> the entry refers to, or 0 if not applicable. <code>name</code> is the value of <a href="qrhiresource.html#name">QRhiResource::name</a>() and may be empty as well. The <code>name</code> will never contain a comma.</p>
<p>This is followed by any number of <code>key, value</code> pairs where <code>key</code> is an unspecified string and <code>value</code> is a number. If <code>key</code> starts with <code>F</code>, it indicates the value is a float. Otherwise assume that the value is a qint64.</p>
</div>
<!-- @@@QRhiProfiler -->
<div class="types">
<h2>Member Type Documentation</h2>
<!-- $$$StreamOp$$$NewBuffer$$$ReleaseBuffer$$$NewBufferStagingArea$$$ReleaseBufferStagingArea$$$NewRenderBuffer$$$ReleaseRenderBuffer$$$NewTexture$$$ReleaseTexture$$$NewTextureStagingArea$$$ReleaseTextureStagingArea$$$ResizeSwapChain$$$ReleaseSwapChain$$$NewReadbackBuffer$$$ReleaseReadbackBuffer$$$GpuMemAllocStats$$$GpuFrameTime$$$FrameToFrameTime$$$FrameBuildTime -->
<h3 class="fn" id="StreamOp-enum"><a name="StreamOp-enum"></a>enum QRhiProfiler::<span class="name">StreamOp</span></h3>
<p>Describes an entry in the profiler's output stream.</p>
<div class="table"><table class="valuelist"><tr valign="top" class="odd"><th class="tblConst">Constant</th><th class="tblval">Value</th><th class="tbldscr">Description</th></tr>
<tr><td class="topAlign"><code>QRhiProfiler::NewBuffer</code></td><td class="topAlign tblval"><code>1</code></td><td class="topAlign">A buffer is created</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::ReleaseBuffer</code></td><td class="topAlign tblval"><code>2</code></td><td class="topAlign">A buffer is destroyed</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::NewBufferStagingArea</code></td><td class="topAlign tblval"><code>3</code></td><td class="topAlign">A staging buffer for buffer upload is created</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::ReleaseBufferStagingArea</code></td><td class="topAlign tblval"><code>4</code></td><td class="topAlign">A staging buffer for buffer upload is destroyed</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::NewRenderBuffer</code></td><td class="topAlign tblval"><code>5</code></td><td class="topAlign">A renderbuffer is created</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::ReleaseRenderBuffer</code></td><td class="topAlign tblval"><code>6</code></td><td class="topAlign">A renderbuffer is destroyed</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::NewTexture</code></td><td class="topAlign tblval"><code>7</code></td><td class="topAlign">A texture is created</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::ReleaseTexture</code></td><td class="topAlign tblval"><code>8</code></td><td class="topAlign">A texture is destroyed</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::NewTextureStagingArea</code></td><td class="topAlign tblval"><code>9</code></td><td class="topAlign">A staging buffer for texture upload is created</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::ReleaseTextureStagingArea</code></td><td class="topAlign tblval"><code>10</code></td><td class="topAlign">A staging buffer for texture upload is destroyed</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::ResizeSwapChain</code></td><td class="topAlign tblval"><code>11</code></td><td class="topAlign">A swapchain is created or resized</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::ReleaseSwapChain</code></td><td class="topAlign tblval"><code>12</code></td><td class="topAlign">A swapchain is destroyed</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::NewReadbackBuffer</code></td><td class="topAlign tblval"><code>13</code></td><td class="topAlign">A staging buffer for readback is created</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::ReleaseReadbackBuffer</code></td><td class="topAlign tblval"><code>14</code></td><td class="topAlign">A staging buffer for readback is destroyed</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::GpuMemAllocStats</code></td><td class="topAlign tblval"><code>15</code></td><td class="topAlign">GPU memory allocator statistics</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::GpuFrameTime</code></td><td class="topAlign tblval"><code>16</code></td><td class="topAlign">GPU frame times</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::FrameToFrameTime</code></td><td class="topAlign tblval"><code>17</code></td><td class="topAlign">CPU frame-to-frame times</td></tr>
<tr><td class="topAlign"><code>QRhiProfiler::FrameBuildTime</code></td><td class="topAlign tblval"><code>18</code></td><td class="topAlign">CPU beginFrame-endFrame times</td></tr>
</table></div>
<!-- @@@StreamOp -->
</div>
<div class="prop">
<h2>Property Documentation</h2>
</div>
<div class="func">
<h2>Member Function Documentation</h2>
<!-- $$$~QRhiProfiler[overload1]$$$~QRhiProfiler -->
<h3 class="fn" id="dtor.QRhiProfiler"><a name="dtor.QRhiProfiler"></a>QRhiProfiler::<span class="name">~QRhiProfiler</span>()</h3>
<p>Destructor.</p>
<!-- @@@~QRhiProfiler -->
<!-- $$$addVMemAllocatorStats[overload1]$$$addVMemAllocatorStats -->
<h3 class="fn" id="addVMemAllocatorStats"><a name="addVMemAllocatorStats"></a><span class="type">void</span> QRhiProfiler::<span class="name">addVMemAllocatorStats</span>()</h3>
<p>Requests writing a <a href="qrhiprofiler.html#StreamOp-enum">GpuMemAllocStats</a> entry into the output, when applicable. Backends that do not support this will ignore the request. This is an explicit request since getting the allocator status and statistics may be an expensive operation.</p>
<!-- @@@addVMemAllocatorStats -->
<!-- $$$frameBuildTimes[overload1]$$$frameBuildTimesQRhiSwapChain* -->
<h3 class="fn" id="frameBuildTimes"><a name="frameBuildTimes"></a><span class="type"><a href="qrhiprofiler-cputime.html">QRhiProfiler::CpuTime</a></span> QRhiProfiler::<span class="name">frameBuildTimes</span>(<span class="type"><a href="qrhiswapchain.html">QRhiSwapChain</a></span> *<i>sc</i>) const</h3>
<p>Returns min, max, and avg in milliseconds for the time that elapsed between a <a href="qrhi.html#beginFrame">QRhi::beginFrame</a>() and <a href="qrhi.html#endFrame">QRhi::endFrame</a>().</p>
<p><b>Note: </b>The values are all 0 until at least <a href="qrhiprofiler.html#frameTimingWriteInterval">frameTimingWriteInterval</a>() frames have been rendered.</p><!-- @@@frameBuildTimes -->
<!-- $$$frameTimingWriteInterval[overload1]$$$frameTimingWriteInterval -->
<h3 class="fn" id="frameTimingWriteInterval"><a name="frameTimingWriteInterval"></a><span class="type">int</span> QRhiProfiler::<span class="name">frameTimingWriteInterval</span>() const</h3>
<p>Returns the currently set frame timing writeout interval.</p>
<p><b>See also </b><a href="qrhiprofiler.html#setFrameTimingWriteInterval">setFrameTimingWriteInterval</a>().</p>
<!-- @@@frameTimingWriteInterval -->
<!-- $$$frameToFrameTimes[overload1]$$$frameToFrameTimesQRhiSwapChain* -->
<h3 class="fn" id="frameToFrameTimes"><a name="frameToFrameTimes"></a><span class="type"><a href="qrhiprofiler-cputime.html">QRhiProfiler::CpuTime</a></span> QRhiProfiler::<span class="name">frameToFrameTimes</span>(<span class="type"><a href="qrhiswapchain.html">QRhiSwapChain</a></span> *<i>sc</i>) const</h3>
<p>Returns min, max, and avg in milliseconds for the time that elapsed between two <a href="qrhi.html#endFrame">QRhi::endFrame</a>() calls.</p>
<p><b>Note: </b>The values are all 0 until at least <a href="qrhiprofiler.html#frameTimingWriteInterval">frameTimingWriteInterval</a>() frames have been rendered.</p><!-- @@@frameToFrameTimes -->
<!-- $$$gpuFrameTimes[overload1]$$$gpuFrameTimesQRhiSwapChain* -->
<h3 class="fn" id="gpuFrameTimes"><a name="gpuFrameTimes"></a><span class="type"><a href="qrhiprofiler-gputime.html">QRhiProfiler::GpuTime</a></span> QRhiProfiler::<span class="name">gpuFrameTimes</span>(<span class="type"><a href="qrhiswapchain.html">QRhiSwapChain</a></span> *<i>sc</i>) const</h3>
<p>Returns min, max, and avg in milliseconds for the GPU time that is spent on one frame.</p>
<p><b>Note: </b>The values are all 0 until at least <a href="qrhiprofiler.html#frameTimingWriteInterval">frameTimingWriteInterval</a>() frames have been rendered.</p><p>The GPU times should only be compared between runs on the same GPU of the same system with the same backend. Comparing times for different graphics cards or for different backends can give misleading results. The numbers are not meant to be comparable that way.</p>
<p><b>Note: </b>Some backends have no support for this, and even for those that have, it is not guaranteed that the driver will support it at run time. Support can be checked via <a href="qrhi.html#Feature-enum">QRhi::Timestamps</a>.</p><!-- @@@gpuFrameTimes -->
<!-- $$$setDevice[overload1]$$$setDeviceQIODevice* -->
<h3 class="fn" id="setDevice"><a name="setDevice"></a><span class="type">void</span> QRhiProfiler::<span class="name">setDevice</span>(<span class="type"><a href="../qtcore/qiodevice.html">QIODevice</a></span> *<i>device</i>)</h3>
<p>Sets the output <i>device</i>.</p>
<p><b>Note: </b>No output will be generated when <a href="qrhi.html#Flag-enum">QRhi::EnableProfiling</a> was not set.</p><!-- @@@setDevice -->
<!-- $$$setFrameTimingWriteInterval[overload1]$$$setFrameTimingWriteIntervalint -->
<h3 class="fn" id="setFrameTimingWriteInterval"><a name="setFrameTimingWriteInterval"></a><span class="type">void</span> QRhiProfiler::<span class="name">setFrameTimingWriteInterval</span>(<span class="type">int</span> <i>frameCount</i>)</h3>
<p>Sets the number of frames that need to be rendered before the collected CPU and GPU timings are processed (min, max, average are calculated) to <i>frameCount</i>.</p>
<p>The default value is 120.</p>
<p><b>See also </b><a href="qrhiprofiler.html#frameTimingWriteInterval">frameTimingWriteInterval</a>().</p>
<!-- @@@setFrameTimingWriteInterval -->
</div>
<div class="vars">
<h2>Member Variable Documentation</h2>
</div>
<div class="relnonmem">
<h2>Related Non-Members</h2>
</div>
<div class="macros">
<h2>Macro Documentation</h2>
</div>
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <acronym title="Copyright">&copy;</acronym> 2018 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.<br/>    Qt and respective logos are trademarks of The Qt Company Ltd.     in Finland and/or other countries worldwide. All other trademarks are property
   of their respective owners. </p>
</div>
</body>
</html>
